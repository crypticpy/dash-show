<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Project Prioritization Dashboard Showcase</title>
  <meta name="description" content="Curated showcase of municipal CIP, Power BI reports, and visualization patterns for project prioritization and ranking.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0f1115;
      --fg: #e8eaed;
      --muted:#9aa0a6;
      --card:#171a21;
      --card-2:#1b1f2a;
      --accent:#3b82f6;
      --accent-2:#22c55e;
      --accent-3:#8b5cf6;
      --border: #283042;
      --chip:#22314b;
      --chip-fg:#dbe8ff;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --shadow-hover: 0 20px 50px rgba(59,130,246,.15);
      --radius: 16px;
      --radius-sm: 12px;
      --radius-xs: 8px;
      --gap: 20px;
      --card-padding: 16px;
      --maxw: 1200px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8fb;
        --fg:#1f2937;
        --muted:#4b5563;
        --card:#ffffff;
        --card-2:#f3f6fb;
        --accent:#2563eb;
        --accent-2:#16a34a;
        --accent-3:#8b5cf6;
        --border:#e5e7eb;
        --chip:#e8f0ff;
        --chip-fg:#1e40af;
        --shadow:0 8px 24px rgba(0,0,0,.08);
        --shadow-hover: 0 16px 40px rgba(37,99,235,.12);
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      padding:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      background:radial-gradient(1200px 600px at 80% -10%, rgba(59,130,246,.12), transparent 70%), var(--bg);
      color:var(--fg);
      line-height:1.5;
      position:relative;
    }
    body::before{
      content:"";
      position:fixed;
      inset:0;
      background-image:radial-gradient(800px 400px at 15% 10%, rgba(139,92,246,0.18), transparent 60%), radial-gradient(600px 300px at 85% 85%, rgba(34,197,94,0.1), transparent 65%), linear-gradient(120deg, rgba(255,255,255,0.05) 0%, transparent 45%, rgba(59,130,246,0.05) 100%);
      pointer-events:none;
      z-index:-1;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    header{
      position:sticky; top:0; z-index:100; backdrop-filter:saturate(120%) blur(12px);
      background:linear-gradient(to bottom, rgba(10,12,16,.92), rgba(10,12,16,.88));
      border-bottom:1px solid var(--border); transition: var(--transition);
    }
    @media (prefers-color-scheme: light){
      header{ background:linear-gradient(to bottom, rgba(255,255,255,.9), rgba(255,255,255,.85)); }
    }
    .wrap{ max-width:var(--maxw); margin:0 auto; padding: 18px 16px; }
    .hero{
      display:flex; align-items:center; gap:20px; flex-wrap:wrap; justify-content:space-between;
    }
    .title{
      display:flex; align-items:flex-start; gap:14px; flex:1 1 420px;
    }
    .logo{
      width:56px; height:56px; border-radius:16px; background:linear-gradient(135deg, var(--accent), var(--accent-2), var(--accent-3));
      box-shadow: var(--shadow); display:grid; place-items:center; color:white; font-weight:800; letter-spacing:.5px;
      position: relative; overflow: hidden;
    }
    .logo::before{
      content: ''; position: absolute; inset: 0; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: translateX(-100%); transition: transform 0.6s;
    }
    .logo:hover::before{
      transform: translateX(100%);
    }
    .logo span{font-size:22px}
    .title-text{flex:1; display:flex; flex-direction:column; gap:6px;}
    .eyebrow{
      margin:0;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:0.14em;
      color:var(--chip-fg);
      background:var(--chip);
      border:1px solid rgba(255,255,255,0.08);
      align-self:flex-start;
      padding:6px 10px;
      border-radius:999px;
      font-weight:600;
    }
    @media (prefers-color-scheme: light){
      .eyebrow{ border-color:rgba(30,64,175,0.15); }
    }
    h1{margin:0; font-size: clamp(22px, 3.2vw, 34px); line-height:1.15}
    .subtitle{margin:0; color:var(--muted); font-size:14px}
    .hero-points{
      display:flex; flex-wrap:wrap; gap:8px; margin-top:6px;
    }
    .hero-point{
      display:inline-flex; align-items:center; gap:6px;
      padding:6px 12px; border-radius:999px; background:rgba(23,26,33,0.65);
      border:1px solid rgba(255,255,255,0.08);
      font-size:12px; color:var(--fg); letter-spacing:0.01em;
    }
    .hero-point span{font-size:13px;}
    @media (prefers-color-scheme: light){
      .hero-point{ background:rgba(255,255,255,0.8); border-color:rgba(30,64,175,0.12); color:var(--muted); }
    }
    .controls{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    .control{
      display:flex; align-items:center; gap:8px; background:var(--card); border:1px solid var(--border);
      padding:10px 12px; border-radius:var(--radius-sm); transition: var(--transition);
    }
    .control:hover{
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    input[type="search"]{
      border:none; background:transparent; color:var(--fg); outline:none; width:260px; font-size:14px;
      transition: var(--transition);
    }
    input[type="search"]:focus{
      width:300px;
    }
    input[type="search"]::placeholder{
      color:var(--muted);
      transition: opacity 0.3s;
    }
    input[type="search"]:focus::placeholder{
      opacity: 0.5;
    }
    select, button{
      border:1px solid var(--border); background:var(--card); color:var(--fg);
      padding:10px 12px; border-radius:var(--radius-sm); font-size:14px; cursor:pointer;
      transition: var(--transition); position: relative; overflow: hidden;
    }
    select:hover, button:hover{
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      filter:brightness(1.05);
    }
    select:focus, button:focus{
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(59,130,246,0.1);
    }
    main{ max-width:var(--maxw); margin:18px auto; padding:0 16px 96px; }
    .stat-row{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      gap:12px;
      margin:24px 0 12px;
    }
    @media (max-width: 480px) {
      .stat-row {
        grid-template-columns: 1fr;
      }
    }
    .stat-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius-sm);
      padding:16px 18px;
      box-shadow:0 10px 30px rgba(0,0,0,0.12);
      display:flex;
      flex-direction:column;
      gap:6px;
      transition:var(--transition);
    }
    .stat-card:hover{
      transform:translateY(-3px);
      box-shadow:var(--shadow-hover);
      border-color:var(--accent);
    }
    .stat-card span{
      font-size:26px;
      font-weight:700;
      color:var(--fg);
    }
    .stat-card small{
      font-size:12px;
      color:var(--muted);
      line-height:1.4;
    }
    .intro-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
      gap:16px;
      margin:12px 0 24px;
    }
    .intro-card{
      background:linear-gradient(160deg, rgba(59,130,246,0.14), rgba(17,24,39,0.4));
      border:1px solid rgba(59,130,246,0.2);
      border-radius:var(--radius);
      padding:20px;
      box-shadow:0 10px 30px rgba(15,17,21,0.3);
      background:linear-gradient(160deg, rgba(59,130,246,0.14), rgba(17,24,39,0.4));
      border:1px solid rgba(59,130,246,0.2);
      border-radius:var(--radius);
      padding:20px;
      box-shadow:0 10px 30px rgba(15,17,21,0.3);
      background-color:rgba(59,130,246,0.08); /* fallback for no blur support */
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    @supports (backdrop-filter: blur(4px)) or (-webkit-backdrop-filter: blur(4px)) {
      .intro-card {
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
      }
    }
    .intro-card h2{
      margin:0;
      font-size:16px;
      color:#fff;
    }
    .intro-card p{ margin:0; font-size:13px; color:rgba(219,232,255,0.86); }
    .intro-card ul{ margin:0; padding-left:18px; display:flex; flex-direction:column; gap:6px; }
    .intro-card li{ font-size:12px; color:rgba(219,232,255,0.9); }
    .intro-card strong{ color:#fff; }
    .intro-card .subtle{ color:rgba(219,232,255,0.75); font-size:11px; letter-spacing:0.03em; text-transform:uppercase; }
    @media (prefers-color-scheme: light){
      .intro-card{
        background:linear-gradient(160deg, rgba(37,99,235,0.12), rgba(255,255,255,0.92));
        border-color:rgba(37,99,235,0.25);
        box-shadow:0 8px 24px rgba(37,99,235,0.12);
      }
      .intro-card h2{ color:var(--fg); }
      .intro-card p, .intro-card li{ color:var(--muted); }
      .intro-card strong{ color:var(--fg); }
      .intro-card .subtle{ color:var(--muted); opacity:0.8; }
    }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin:14px 0 6px; }
    .chip{
      padding:8px 12px; background:var(--chip); color:var(--chip-fg); border-radius:999px; font-size:12px;
      border:1px solid rgba(255,255,255,.1); cursor:pointer; user-select:none; transition: var(--transition);
      position: relative; overflow: hidden;
    }
    .chip::before{
      content: ''; position: absolute; inset: 0; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: translateX(-100%); transition: transform 0.4s;
    }
    .chip:hover::before{
      transform: translateX(100%);
    }
    .chip:hover{
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .chip[aria-pressed="true"]{ 
      background:linear-gradient(135deg, var(--accent), var(--accent-2), var(--accent-3)); 
      color:white; 
      border-color: transparent;
      box-shadow: 0 2px 12px rgba(59,130,246,0.3);
    }
    .grid{
      display:grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap:var(--gap); margin-top:20px;
    }
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      overflow:hidden; box-shadow: var(--shadow); display:flex; flex-direction:column; min-height:380px;
      transition:var(--transition); position: relative;
    }
    .card::before{
      content: ''; position: absolute; inset: 0; background: linear-gradient(to bottom, transparent, rgba(59,130,246,0.05));
      opacity: 0; transition: opacity 0.3s ease; pointer-events: none;
    }
    .card:hover{ 
      transform: translateY(-4px) scale(1.02); 
      box-shadow: var(--shadow-hover);
      border-color: var(--accent);
    }
    .card:hover::before{
      opacity: 1;
    }
    .thumb{
      position:relative; height:180px; background:var(--card-2); overflow:hidden;
    }
    .thumb img{
      width:100%; height:100%; object-fit:cover; display:block; opacity:0; transition:opacity 0.5s ease, transform 0.3s ease;
    }
    .thumb img.loaded{ opacity:1; }
    .card:hover .thumb img{
      transform: scale(1.05);
    }
    .badge{
      position:absolute; left:10px; top:10px; font-size:11px; background:rgba(0,0,0,.55);
      padding:6px 8px; border-radius:999px; color:#fff; border:1px solid rgba(255,255,255,.15);
    }
    @media (prefers-color-scheme: light){
      .badge{ background:rgba(0,0,0,.35); }
    }
    .content{ padding:var(--card-padding); display:flex; flex-direction:column; gap:8px; flex:1; }
    .title-row{ display:flex; gap:8px; align-items:flex-start; justify-content:space-between; }
    .card h3{ margin:0; font-size:16px; line-height:1.25; }
    .domain{ color:var(--muted); font-size:12px; }
    .blurb{ color:var(--fg); opacity:.9; font-size:13px; margin-top:4px; }
    .tags{ display:flex; flex-wrap:wrap; gap:8px; margin-top:auto; }
    .tag{ font-size:11px; padding:4px 8px; border-radius:999px; border:1px dashed var(--border); color:var(--muted); }
    .actions{ display:flex; gap:10px; margin-top:8px; }
    .btn{
      display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px;
      background:var(--card-2); border:1px solid var(--border); color:var(--fg); font-size:13px;
      text-decoration:none; transition: var(--transition); position: relative; overflow: hidden;
    }
    .btn::before{
      content: ''; position: absolute; inset: 0; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: translateX(-100%); transition: transform 0.4s;
    }
    .btn:hover::before{
      transform: translateX(100%);
    }
    .btn.primary{ background:linear-gradient(135deg, var(--accent), var(--accent-2), var(--accent-3)); color:#fff; border:none; }
    .btn.primary:hover{ 
      box-shadow: 0 4px 20px rgba(59,130,246,0.3);
      transform: translateY(-1px);
    }
    .btn:hover{ 
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .meta{ margin-top:20px; color:var(--muted); font-size:12px; }
    .footer{
      border-top:1px solid var(--border); padding:32px 16px; color:var(--muted); text-align:center;
      background:linear-gradient(to top, rgba(0,0,0,.12), transparent);
    }
    .skeleton{
      background:linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.12), rgba(255,255,255,.06));
      background-size:200% 100%; animation:shimmer 1.5s infinite;
    }
    @keyframes shimmer { to{ background-position:-200% 0; } }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    .logo:hover{
      animation: pulse 2s infinite;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .card{
      animation: fadeIn 0.6s ease-out forwards;
      animation-delay: calc(var(--index, 0) * 0.1s);
    }
    .skeleton.text{ height:12px; border-radius:6px; opacity:.7 }
    .skeleton.thumb{ height:180px; }
    .toolbar{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin-top:10px; }
    .notice{ font-size:12px; color:var(--muted); }
    
    /* Learning Panel Styles */
    .learning-panel, .compare-panel{
      position:fixed; top:80px; right:20px; width:380px; max-height:80vh;
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      box-shadow: var(--shadow-hover); z-index:200; overflow-y:auto;
      backdrop-filter:saturate(120%) blur(12px);
    }
    .learning-header, .compare-header{
      display:flex; justify-content:space-between; align-items:center;
      padding:16px; border-bottom:1px solid var(--border);
    }
    .learning-header h3, .compare-header h3{
      margin:0; font-size:16px; color:var(--fg);
    }
    .close-btn{
      background:none; border:none; color:var(--muted); font-size:20px;
      cursor:pointer; padding:4px; border-radius:4px; transition: var(--transition);
    }
    .close-btn:hover{
      background:var(--card-2); color:var(--fg);
    }
    .learning-content, .compare-content{
      padding:16px;
    }
    .learning-section{
      margin-bottom:20px;
    }
    .learning-section h4{
      margin:0 0 8px; font-size:14px; color:var(--accent);
    }
    .learning-section ul{
      margin:0; padding-left:16px; list-style:none;
    }
    .learning-section li{
      margin-bottom:6px; font-size:12px; line-height:1.4;
    }
    .learning-section strong{
      color:var(--fg);
    }
    
    /* Compare Mode Styles */
    .compare-slots{
      display:grid; grid-template-columns:1fr 1fr; gap:12px; margin:16px 0;
    }
    .compare-slot{
      min-height:60px; border:2px dashed var(--border); border-radius:var(--radius-sm);
      display:flex; align-items:center; justify-content:center; font-size:12px;
      color:var(--muted); transition: var(--transition);
    }
    .compare-slot.filled{
      border-color:var(--accent); background:var(--chip);
      color:var(--chip-fg);
      font-size:11px;
    }
    .compare-slot.selected{
      border-color:var(--accent-2); background:rgba(34,197,94,0.1);
    }
    
    /* Learning Mode Indicators */
    .learning-mode .card{
      position:relative;
    }
    .learning-mode .card::after{
      content: '📊'; position:absolute; top:10px; right:10px; 
      background:var(--accent); color:white; width:24px; height:24px;
      border-radius:50%; display:flex; align-items:center; justify-content:center;
      font-size:12px; opacity:0; transition: opacity 0.3s;
    }
    .learning-mode .card:hover::after{
      opacity:1;
    }
    
    /* Compare Mode Indicators */
    .compare-mode .card{
      cursor:pointer; position:relative;
    }
    .compare-mode .card:hover{
      box-shadow: 0 0 0 2px var(--accent);
    }
    .compare-mode .card.selected-for-compare{
      box-shadow: 0 0 0 3px var(--accent-2);
      transform:scale(1.02);
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap hero">
      <div class="title">
        <div class="logo" aria-hidden="true"><span>PP</span></div>
        <div class="title-text">
          <p class="eyebrow">Austin DIVE DLC Cohort 2025 ///</p>
          <h1>Project Prioritization Dashboard Showcase</h1>
          <p class="subtitle">47 examples across municipal CIP, Power BI, portfolio management tools, and data visualization patterns for teaching effective dashboard design.</p>
          <div class="hero-points" aria-label="Key cohort takeaways">
            <span class="hero-point"><span>🧭</span>Prioritize civic impact with clarity</span>
            <span class="hero-point"><span>🧪</span>Experiment with scoring frameworks</span>
            <span class="hero-point"><span>🗣️</span>Guide conversations across departments</span>
          </div>
        </div>
      </div>
      <div class="controls">
        <div class="control">
          🔎 <input id="q" type="search" placeholder="Search title, domain, tags…" autocomplete="off">
        </div>
        <select id="filterTag" title="Filter by tag">
          <option value="all">All types</option>
          <option value="Public CIP">Public CIP</option>
          <option value="Power BI">Power BI</option>
          <option value="Visualization Patterns">Visualization Patterns</option>
          <option value="Portfolio Management">Portfolio Management</option>
        </select>
        <select id="sortBy" title="Sort">
          <option value="default">Sort: Default</option>
          <option value="title">Sort: Title (A→Z)</option>
          <option value="domain">Sort: Domain (A→Z)</option>
        </select>
        <button id="refresh">Refresh blurbs</button>
        <button id="toggleLearning">📚 Learning Mode</button>
        <button id="toggleCompare">🔍 Compare Mode</button>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <section class="stat-row" aria-label="Gallery overview">
        <div class="stat-card">
          <span>47</span>
          <small>Total exemplars curated for the cohort</small>
        </div>
        <div class="stat-card">
          <span>20</span>
          <small>Municipal capital project dashboards (Public CIP)</small>
        </div>
        <div class="stat-card">
          <span>20</span>
          <small>Portfolio management and prioritization playbooks</small>
        </div>
        <div class="stat-card">
          <span>7</span>
          <small>Power BI & visualization pattern spotlights</small>
        </div>
      </section>

      <section class="intro-grid" aria-label="How to use this gallery">
        <article class="intro-card">
          <p class="subtle">Cohort framing</p>
          <h2>Set the stage for your exploration</h2>
          <p>Ground yourself in a shared definition of prioritization. Notice how each dashboard balances transparency, outcomes, and feasibility as you browse.</p>
          <ul>
            <li><strong>Start with purpose:</strong> Consider who relies on each dashboard and the questions it helps them answer.</li>
            <li><strong>Spot context cues:</strong> Let navigation, legends, and copy guide the narrative.</li>
          </ul>
        </article>

        <article class="intro-card">
          <p class="subtle">Guided critique</p>
          <h2>Compare design decisions</h2>
          <p>Use Compare Mode to line up two dashboards. Evaluate how encoding choices, accessibility details, and prioritization scores earn your trust.</p>
          <ul>
            <li><strong>What changes:</strong> Layouts shift between matrices, bubbles, and tables.</li>
            <li><strong>What stays consistent:</strong> Color, hierarchy, and language reinforce rankings.</li>
          </ul>
        </article>

        <article class="intro-card">
          <p class="subtle">Workshop prompts</p>
          <h2>Move from insight to action</h2>
          <p>Channel inspiration into a sketching session. Remix a dashboard pattern to tackle an Austin department challenge.</p>
          <ul>
            <li><strong>Define inputs:</strong> Choose criteria weights, scoring formulas, and refresh cadences that fit your scenario.</li>
            <li><strong>Design for delivery:</strong> Plan how stakeholders will explore, annotate, or export their decisions.</li>
          </ul>
        </article>
      </section>

      <div class="chips" id="chips">
        <!-- dynamic chip badges rendered here -->
      </div>

      <div class="grid" id="grid" aria-live="polite">
        <!-- cards populated via JS -->
      </div>

      <p class="meta notice">Thumbnails are generated from public URLs using snapshot services. Blurbs are fetched automatically from each page’s readable content (proxied for CORS). If a site blocks snapshots or content, the card will fall back gracefully.</p>
      <p class="meta notice">Tip: Enable 📚 Learning Mode to surface teaching cues or toggle 🔍 Compare Mode to spark critique discussions with the cohort.</p>
      
      <!-- Learning Panel Overlay -->
      <div id="learningPanel" class="learning-panel" style="display: none;">
        <div class="learning-header">
          <h3>📚 Data Visualization Learning Mode</h3>
          <button id="closeLearning" class="close-btn">×</button>
        </div>
        <div class="learning-content">
          <div class="learning-section">
            <h4>🎯 Key Principles</h4>
            <ul>
              <li><strong>Data-Ink Ratio</strong>: Maximize data pixels, minimize non-data ink</li>
              <li><strong>Gestalt Principles</strong>: Proximity, similarity, continuity guide perception</li>
              <li><strong>Color Theory</strong>: Use color purposefully, ensure accessibility</li>
              <li><strong>Progressive Disclosure</strong>: Show details on demand, avoid overwhelm</li>
            </ul>
          </div>
          <div class="learning-section">
            <h4>🔍 Look for These Patterns</h4>
            <ul>
              <li><strong>Heatmaps</strong>: Color intensity showing values/concentration</li>
              <li><strong>Bubble Charts</strong>: Size + position + color encoding multiple dimensions</li>
              <li><strong>Matrices</strong>: Grid layouts for comparison (Value vs Effort, Risk vs Return)</li>
              <li><strong>WSJF</strong>: Weighted Shortest Job First prioritization methodology</li>
              <li><strong>MCDA</strong>: Multi-Criteria Decision Analysis frameworks</li>
            </ul>
          </div>
          <div class="learning-section">
            <h4>⚡ Accessibility Checklist</h4>
            <ul>
              <li>☐ Sufficient color contrast (4.5:1 minimum)</li>
              <li>☐ Screen reader compatible labels</li>
              <li>☐ Keyboard navigation support</li>
              <li>☐ Data table alternatives for charts</li>
              <li>☐ High contrast mode compatibility</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Compare Mode Panel -->
      <div id="comparePanel" class="compare-panel" style="display: none;">
        <div class="compare-header">
          <h3>🔍 Compare Dashboards</h3>
          <button id="closeCompare" class="close-btn">×</button>
        </div>
        <div class="compare-content">
          <p>Click on 2 dashboards to compare their design patterns, data density, and effectiveness.</p>
          <div id="compareSlots" class="compare-slots">
            <div class="compare-slot" data-slot="1">+ Select first dashboard</div>
            <div class="compare-slot" data-slot="2">+ Select second dashboard</div>
          </div>
          <button id="startCompare" class="btn primary" disabled>Compare Selected</button>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="wrap">
      <div>Static site, no tracking, no frameworks. Host on GitHub Pages.</div>
    </div>
  </footer>

  <script>
    // ======== Configuration: curated list ========
    // Tags: "Public CIP", "Power BI", "Visualization Patterns", "Portfolio Management"
    const SITES = [
      { title: "NYC Capital Projects Dashboard", url: "https://www.nyc.gov/site/operations/performance/capital-projects-dashboard.page", tags:["Public CIP"] },
      { title: "Seattle DOT Capital Projects", url: "https://capitalprojects.seattle.gov/", tags:["Public CIP"] },
      { title: "Charlotte, NC — Capital Projects", url: "https://www.charlottenc.gov/Growth-and-Development/Projects/Capital-Projects-Dashboard", tags:["Public CIP"] },
      { title: "Richmond, VA — Capital Improvement Program", url: "https://rva.gov/budget-and-strategic-planning/cip", tags:["Public CIP"] },
      { title: "Richmond, CA — CIP (BETA)", url: "https://richmondca.gov/158/Capital-Improvement-Program", tags:["Public CIP"] },
      { title: "St. Helena, CA — CIP Dashboard", url: "https://www.cityofsthelena.gov/490/CIP-Interactive-Dashboard", tags:["Public CIP"] },
      { title: "Hillsborough County, FL — Project Map Viewer", url: "https://hcfl.gov/residents/property-owners-and-renters/roads-and-sidewalks/project-map-viewer", tags:["Public CIP"] },
      { title: "Palm Coast, FL — Capital Projects", url: "https://www.palmcoast.gov/capitalprojects", tags:["Public CIP"] },
      { title: "Jacksonville, FL — CIP Dashboard", url: "https://www.jacksonville.gov/mayor/mayor-s-transparency-dashboards/capital-improvement-projects-dashboard", tags:["Public CIP"] },
      { title: "Stuart, FL — Capital Improvement Projects", url: "https://www.stuartfl.gov/532/Capital-Improvement-Projects-Dashboard", tags:["Public CIP"] },
      { title: "Ann Arbor, MI — FY2026-2031 Capital Improvements Plan", url: "http://a2gov.org/a2cipmap", tags:["Public CIP"] },
      { title: "San Diego County, CA — 2025-2030 Capital Plan", url: "https://engage.sandiegocounty.gov/capitalplan25-30", tags:["Public CIP"] },
      { title: "Baltimore City, MD — FY25-30 Capital Improvement Program", url: "https://planning.baltimorecity.gov/sites/default/files/FY2530_CIP-Recommendation-Report_final_0.pdf", tags:["Public CIP"] },
      { title: "Deerfield Beach, FL — Capital Project Dashboard", url: "https://www.arcgis.com/apps/dashboards/9aecec5400934abfac6f163132def27f", tags:["Public CIP"] },
      { title: "Lawrence, KS — Capital Improvement Project Map", url: "https://lawrenceks.maps.arcgis.com/apps/dashboards/326b2951772a468a9d139787d19dc3f4", tags:["Public CIP"] },
      { title: "Morristown, TN — Capital Projects StoryMap", url: "https://storymaps.arcgis.com/stories/d83accd2177545c8a05ef4f12b8d2f22", tags:["Public CIP"] },
      { title: "Los Angeles County DPW — Projects", url: "https://dpw.lacounty.gov/projects/", tags:["Public CIP"] },
      { title: "Torrance, CA — CIP Dashboard", url: "https://www.torranceca.gov/government/city-departments/finance/financial-documents/capital-improvement-plan-dashboard", tags:["Public CIP"] },
      { title: "Normal, IL — Community Investment Plan", url: "https://www.normalil.gov/1006/Community-Investment-Plan", tags:["Public CIP"] },
      { title: "Great Lakes Water Authority — Five‑Year CIP (Power BI)", url: "https://app.powerbigov.us/view?r=eyJrIjoiNmU4Njk3NjAtYzRlNi00YzUxLWFmYzQtMzQ4OGU5YzI5MGIyIiwidCI6IjRlOGZmNjJlLWU2ODYtNGIxZi1hZWI0LTYyZDdjMTY4NjY1MyJ9", tags:["Power BI"] },
      { title: "Minneapolis Park & Recreation Board — CIP (Power BI)", url: "https://app.powerbigov.us/view?pageName=ReportSection9b43331538d7a4beb394&r=eyJrIjoiMjE4YmI2ZjItYWZmMS00NTVlLThiOWQtMDhjMzlmYzc1NzI1IiwidCI6IjY0OTc4ZmFiLTY0NWMtNDljZS1iODMzLTc1NDYyMzYxMmQyMiJ9", tags:["Power BI"] },
      { title: "City of Norfolk, VA — Adopted CIP FY2025 (Power BI)", url: "https://app.powerbigov.us/view?r=eyJrIjoiNjkwMTQ3ZGEtYzIzNy00NWI2LTk1NzQtMmVlZjdmMzEwY2FiIiwidCI6IjUzODZkMzU1LTJmYWUtNGZlOC05MTc0LWI4OWU0MDhiYTk5MSJ9", tags:["Power BI"] },
      { title: "Chesterfield County, VA — CIP Explorer (Power BI)", url: "https://app.powerbigov.us/view?r=eyJrIjoiMTgyZTkxZDQtZWVjZi00ZjVlLWEyYmQtOWM5Y2I5YmNiMTg1IiwidCI6IjA1NjA5MzMyLWI5MDUtNGE2Yi1iZjc0LTQ4MDdmYTg5ODU3ZCJ9", tags:["Power BI"] },
      { title: "Envisio — Public Dashboard Examples (Gallery)", url: "https://envisio.com/dashboard-examples/", tags:["Visualization Patterns"] },
      { title: "Acuity PPM — Portfolio Charts & Priority Heatmaps", url: "https://acuityppm.com/the-pmo-guide-to-portfolio-management-charts/", tags:["Visualization Patterns"] },
      
      // Project Prioritization & Portfolio Management Tools
      { title: "Aha! Roadmaps — Prioritization (Scorecards & Ranking)", url: "https://www.aha.io/roadmaps/prioritization", tags:["Portfolio Management"] },
      { title: "Productboard — Prioritization Matrix (Value × Effort)", url: "https://support.productboard.com/hc/en-us/articles/360056350174-Use-the-prioritization-matrix", tags:["Portfolio Management"] },
      { title: "airfocus — Priority Ratings & Scoring (Weighted Matrices)", url: "https://help.airfocus.com/en/articles/2788532-priority-ratings-app", tags:["Portfolio Management"] },
      { title: "Planview Advisor — Portfolio Visualizations (Bullseye, Treemap)", url: "https://www.planview.com/products-solutions/products/advisor/", tags:["Portfolio Management"] },
      { title: "Meisterplan — Portfolio Dashboard (Configurable Charts)", url: "https://help.meisterplan.com/hc/en-us/articles/11289973015068-Portfolio-Dashboard", tags:["Portfolio Management"] },
      { title: "OnePlan — Portfolio Modeler (Projects Ranked by Score)", url: "https://support.oneplan.ai/hc/en-us/articles/24187952450445-Portfolio-Planning-Portfolio-Modeler", tags:["Portfolio Management"] },
      { title: "Adobe Workfront — Portfolio Optimizer Score (Auto Ranking)", url: "https://experienceleague.adobe.com/en/docs/workfront/using/manage-work/portfolio-management/manage-projects-in-portfolio-optimizer/portfolio-optimizer-score", tags:["Portfolio Management"] },
      { title: "Apptio Targetprocess — WSJF Prioritization (SAFe)", url: "https://www.apptio.com/solutions/agile/full-safe-tool/", tags:["Portfolio Management"] },
      { title: "Atlassian Jira Align — Prioritize Features (WSJF)", url: "https://help.jiraalign.com/hc/en-us/articles/115000102373-Prioritize-features", tags:["Portfolio Management"] },
      { title: "Microsoft Project — Portfolio Analysis Driver-Based Prioritization", url: "https://learn.microsoft.com/en-us/project/portfolio-analysis-driver-prioritization", tags:["Portfolio Management"] },
      { title: "Oracle Primavera Cloud — Investor Map (Portfolio Bubble Chart)", url: "https://primavera.oraclecloud.com/help/en/user/102917.htm", tags:["Portfolio Management"] },
      { title: "Oracle Primavera Cloud — Prioritization Matrix (Evaluation & Ranking)", url: "https://docs.oracle.com/cd/E80480_01/help/en/user/102189.htm", tags:["Portfolio Management"] },
      { title: "Planisware — Portfolio Heat Maps & Bubble Charts", url: "https://www.planisware.com/resources/strategic-planning-alignment/aligning-your-projects-business-strategies-best-practices", tags:["Portfolio Management"] },
      { title: "Expert Choice Comparion — AHP Portfolio Prioritization", url: "https://www.expertchoice.com/comparion", tags:["Portfolio Management"] },
      { title: "D-Sight — MCDA Decision Portfolio Dashboards", url: "https://www.d-sight.com/", tags:["Portfolio Management"] },
      { title: "1000minds — Results & Ranking Views (Priority Values)", url: "https://www.1000minds.com/tutorials/results", tags:["Portfolio Management"] },
      { title: "ServiceNow — Application Assessments Dashboard (Portfolio Scoring)", url: "https://www.servicenow.com/docs/bundle/yokohama-application-portfolio-management/page/product/application-portfolio-management/task/use-appln-assessment-dashboard.html", tags:["Portfolio Management"] },
      { title: "SAP LeanIX — Application Portfolio Management Dashboard", url: "https://help.sap.com/docs/leanix/ea/application-portfolio-management-dashboard", tags:["Portfolio Management"] },
      { title: "Strategyzer — Business Portfolio Map (Risk × Return)", url: "https://www.strategyzer.com/library/business-model-portfolio-part-3-the-business-portfolio-map", tags:["Portfolio Management"] },
      { title: "SmartOrg Portfolio Navigator — Efficient Frontier & Innovation Screens", url: "https://smartorg.com/portfolio-navigator/", tags:["Portfolio Management"] }
    ];

    // ======== Utility helpers ========
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const hostname = url => {
      try{ return new URL(url).hostname.replace(/^www\./,''); } catch { return url; }
    };

    const screenshotURL = (url, width=640) =>
      `https://s.wordpress.com/mshots/v1/${encodeURIComponent(url)}?w=${width}`;

    const screenshotFallback = (url) =>
      `https://image.thum.io/get/width/1200/crop/900/${url}`;

    const faviconURL = (url) => {
      const host = hostname(url);
      return `https://www.google.com/s2/favicons?domain=${host}&sz=256`;
    };

    const proxiedReadableURL = (url) => {
      // Use Jina reader proxy to bypass CORS and get readable content
      const clean = url.replace(/^https?:\/\//,'');
      return `https://r.jina.ai/http://${clean}`;
    };

    const truncate = (s, n=260) => (s && s.length > n) ? (s.slice(0, n-1) + "…") : s || "";

    function createChip(tagText){
      const chip = document.createElement('button');
      chip.className = 'chip';
      chip.textContent = tagText;
      chip.type = 'button';
      chip.dataset.tag = tagText;
      chip.setAttribute('aria-pressed', 'false');
      chip.addEventListener('click', () => {
        const pressed = chip.getAttribute('aria-pressed') === 'true';
        chip.setAttribute('aria-pressed', String(!pressed));
        applyFilters();
      });
      return chip;
    }

    // ======== Build UI ========
    const grid = $('#grid');
    const chipsWrap = $('#chips');

    // Dynamic tag chips (derived from SITES)
    const allTags = Array.from(new Set(SITES.flatMap(s => s.tags))).sort();
    allTags.forEach(t => chipsWrap.appendChild(createChip(t)));

    function cardTemplate(item){
      const host = hostname(item.url);
      const elm = document.createElement('article');
      elm.className = 'card';
      elm.dataset.tags = (item.tags||[]).join('|').toLowerCase();
      elm.dataset.title = (item.title||'').toLowerCase();
      elm.dataset.domain = host.toLowerCase();
      
      // Add click handler for compare mode
      elm.addEventListener('click', (e) => {
        if (!e.target.closest('.btn') && !e.target.closest('.tag')) {
          handleCardClick(elm, item);
        }
      });

      elm.innerHTML = `
        <div class="thumb">
          <img alt="Thumbnail for ${escapeHtml(item.title)}" loading="lazy" decoding="async" data-src="${screenshotURL(item.url)}">
          <span class="badge">${host}</span>
        </div>
        <div class="content">
          <div class="title-row">
            <h3>${escapeHtml(item.title)}</h3>
          </div>
          <div class="domain">${host}</div>
          <div class="blurb">
            <div class="skeleton text" style="width:85%; margin-bottom:8px;"></div>
            <div class="skeleton text" style="width:70%; margin-bottom:8px;"></div>
            <div class="skeleton text" style="width:60%;"></div>
          </div>
          <div class="tags">${(item.tags||[]).map(t => `<span class="tag">${escapeHtml(t)}</span>`).join("")}</div>
          <div class="actions">
            <a class="btn primary" href="${item.url}" target="_blank" rel="noopener">Visit site ↗</a>
            <a class="btn" href="${item.url}" target="_blank" rel="noopener">Open in new tab</a>
          </div>
        </div>
      `;
      return elm;
    }

    function build(){
      grid.innerHTML = '';
      SITES.forEach((item, index) => {
        const card = cardTemplate(item);
        card.style.setProperty('--index', index);
        grid.appendChild(card);
      });
      setupLazyImages();
      hydrateBlurbs();
    }

    // ======== Blurbs (with caching) ========
    const CACHE_KEY = 'pp-showcase-blurbs-v1';
    const cache = JSON.parse(localStorage.getItem(CACHE_KEY) || '{}');

    function saveCache(){ localStorage.setItem(CACHE_KEY, JSON.stringify(cache)); }

    async function fetchBlurb(url){
      // Try cache first
      const cached = cache[url];
      if (cached && cached.text && Date.now() - cached.ts < 1000*60*60*24*7) { // 7 days
        return cached.text;
      }
      try{
        const res = await fetch(proxiedReadableURL(url), { mode: 'cors' });
        if(!res.ok) throw new Error('bad status');
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        // Prefer first reasonable <p>
        let text = "";
        const ps = Array.from(doc.querySelectorAll('p'))
          .map(p => (p.textContent||"").trim())
          .filter(t => t.split(/\s+/).length >= 10 && !/cookie|javascript|enable|subscribe|sign in|accept/i.test(t));
        if(ps.length) text = ps[0];
        if(!text){
          // fallback: first long text node from body
          const raw = (doc.body && doc.body.textContent || "").trim();
          const candidate = raw.split(/\n{2,}/).find(s => s.trim().length > 80);
          text = candidate || "";
        }
        text = truncate(text, 280);
        if(text){
          cache[url] = { text, ts: Date.now() };
          saveCache();
        }
        return text;
      }catch(e){
        return "";
      }
    }

    async function hydrateBlurbs(){
      const cards = $$('.card');
      for (const card of cards){
        const url = $('.btn.primary', card).getAttribute('href');
        const blurbEl = $('.blurb', card);
        const text = await fetchBlurb(url);
        if (text){
          blurbEl.textContent = text;
        } else {
          blurbEl.innerHTML = '<span class="notice">Blurb unavailable (site blocked or no readable text).</span>';
        }
      }
    }

    // ======== Lazy-load screenshots with fallbacks ========
    function setupLazyImages(){
      const imgs = $$('img[data-src]');
      const io = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if(entry.isIntersecting){
            const img = entry.target;
            img.src = img.dataset.src;
            img.addEventListener('load', () => img.classList.add('loaded'));
            img.addEventListener('error', () => {
              // Fallback chain: thum.io → favicon
              img.onerror = () => { img.src = faviconURL(img.closest('.card').querySelector('.btn.primary').href); };
              img.src = screenshotFallback(img.closest('.card').querySelector('.btn.primary').href);
            });
            io.unobserve(img);
          }
        });
      }, { rootMargin: '200px' });
      imgs.forEach(img => io.observe(img));
    }

    // ======== Search, filter, sort ========
    const q = $('#q');
    const filterTag = $('#filterTag');
    const sortBy = $('#sortBy');
    const refreshBtn = $('#refresh');
    const learningBtn = $('#toggleLearning');
    const compareBtn = $('#toggleCompare');
    const learningPanel = $('#learningPanel');
    const comparePanel = $('#comparePanel');
    const closeLearning = $('#closeLearning');
    const closeCompare = $('#closeCompare');
    
    // State management
    let learningMode = false;
    let compareMode = false;
    let selectedForCompare = [];
    
    // Panel controls
    learningBtn.addEventListener('click', () => {
      learningMode = !learningMode;
      learningPanel.style.display = learningMode ? 'block' : 'none';
      document.body.classList.toggle('learning-mode', learningMode);
      learningBtn.textContent = learningMode ? '📚 Exit Learning' : '📚 Learning Mode';
    });
    
    compareBtn.addEventListener('click', () => {
      compareMode = !compareMode;
      comparePanel.style.display = compareMode ? 'block' : 'none';
      document.body.classList.toggle('compare-mode', compareMode);
      compareBtn.textContent = compareMode ? '🔍 Exit Compare' : '🔍 Compare Mode';
      if (!compareMode) {
        selectedForCompare = [];
        updateCompareSlots();
        updateCardSelection();
      }
    });
    
    closeLearning.addEventListener('click', () => {
      learningMode = false;
      learningPanel.style.display = 'none';
      document.body.classList.remove('learning-mode');
      learningBtn.textContent = '📚 Learning Mode';
    });
    
    closeCompare.addEventListener('click', () => {
      compareMode = false;
      comparePanel.style.display = 'none';
      document.body.classList.remove('compare-mode');
      compareBtn.textContent = '🔍 Compare Mode';
      selectedForCompare = [];
      updateCompareSlots();
      updateCardSelection();
    });
    
    // Compare functionality
    function handleCardClick(card, item) {
      if (!compareMode) return;
      
      event.preventDefault();
      
      const index = selectedForCompare.findIndex(s => s.url === item.url);
      if (index > -1) {
        selectedForCompare.splice(index, 1);
      } else if (selectedForCompare.length < 2) {
        selectedForCompare.push(item);
      }
      
      updateCardSelection();
      updateCompareSlots();
    }
    
    function updateCardSelection() {
      const cards = $$('.card');
      cards.forEach(card => {
        const url = $('.btn.primary', card).getAttribute('href');
        const isSelected = selectedForCompare.some(s => s.url === url);
        card.classList.toggle('selected-for-compare', isSelected);
      });
    }
    
    function updateCompareSlots() {
      const slots = $$('.compare-slot');
      slots.forEach((slot, index) => {
        const item = selectedForCompare[index];
        if (item) {
          slot.textContent = item.title;
          slot.classList.add('filled');
        } else {
          slot.textContent = `+ Select ${index === 0 ? 'first' : 'second'} dashboard`;
          slot.classList.remove('filled');
        }
      });
      
      $('#startCompare').disabled = selectedForCompare.length !== 2;
    }
    
    $('#startCompare').addEventListener('click', () => {
      if (selectedForCompare.length === 2) {
        const [first, second] = selectedForCompare;
        alert(`Comparison Analysis:\n\n${first.title}\nvs\n${second.title}\n\nKey differences in design patterns, data density, and effectiveness would be displayed here in a full implementation.`);
      }
    });

    function applyFilters(){
      const query = q.value.trim().toLowerCase();
      const selectTag = filterTag.value;
      const pressedChips = $$('.chip[aria-pressed="true"]').map(c => c.dataset.tag);

      const cards = $$('.card');
      cards.forEach(card => {
        const title = card.dataset.title;
        const domain = card.dataset.domain;
        const tags = card.dataset.tags.split('|').filter(Boolean);

        const matchesQuery = !query || title.includes(query) || domain.includes(query) || tags.some(t => t.includes(query));
        const matchesSelect = (selectTag === 'all') || tags.includes(selectTag.toLowerCase());
        const matchesChips = pressedChips.length === 0 || pressedChips.every(t => tags.includes(t.toLowerCase()));

        card.style.display = (matchesQuery && matchesSelect && matchesChips) ? '' : 'none';
      });

      // Sorting
      const visibleCards = $$('.card').filter(c => c.style.display !== 'none');
      const container = grid;
      const key = sortBy.value;
      if (key !== 'default'){
        visibleCards.sort((a,b) => {
          if (key === 'title') return a.dataset.title.localeCompare(b.dataset.title);
          if (key === 'domain') return a.dataset.domain.localeCompare(b.dataset.domain);
          return 0;
        });
        visibleCards.forEach(c => container.appendChild(c));
      }
    }

    q.addEventListener('input', applyFilters);
    filterTag.addEventListener('change', applyFilters);
    sortBy.addEventListener('change', applyFilters);
    refreshBtn.addEventListener('click', () => {
      // Clear cache and re-hydrate
      localStorage.removeItem(CACHE_KEY);
      Object.keys(cache).forEach(k => delete cache[k]);
      hydrateBlurbs();
    });

    // ======== HTML escape helper ========
    function escapeHtml(s=''){
      return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    // ======== Init ========
    build();
    applyFilters();
  </script>
</body>
</html>
